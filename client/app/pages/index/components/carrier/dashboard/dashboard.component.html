<div class="dashboard">
  <loading show-loading="$ctrl.showLoading"></loading>
  <div ng-if="!$ctrl.showLoading">
    <div class="container-fluid carrier-dashboard-header">
      <div class="container">
        <ul class="list-inline carrier-dashboard-header_left">
          <li>
            <strong ng-if="$ctrl.showMap && !$ctrl.showLoadDetailsMap">{{$ctrl.mapPoints.length}} Loads Located</strong>
            <strong ng-if="$ctrl.showMap && $ctrl.showLoadDetailsMap">{{::$ctrl.stopCount}} Load Stops</strong>
          </li>
        </ul>
        <echo-rep-contact class="list-inline carrier-dashboard-header_right" rep-details="$ctrl.repDetails"></echo-rep-contact>
      </div>
    </div>
    <load-map ng-if="$ctrl.showExpandedMap" show-map="$ctrl.showMap" map-points="$ctrl.mapPoints" detailed-info="true" show-expanded="true"
              view-map-handler="$ctrl.viewMapHandler(mapPoint)" carrier-id="$ctrl.carrierId" map-refresh-handler="$ctrl.refreshPageData()"></load-map>
    <origin-destination-map ng-if="$ctrl.showLoadDetailsMap" map-point="$ctrl.loadDetailsMapPoint"></origin-destination-map>
      <div class="col-xs-offset-5 col-xs-2 text-center">
        <button ng-if="$ctrl.showExpandedMap || $ctrl.showLoadDetailsMap" ng-click="$ctrl.shrinkMap()" class="btn back-to-dashboard-button">Back to Dashboard</button>
      </div>
    <div ng-if="!$ctrl.showExpandedMap && !$ctrl.showLoadDetailsMap">
      <load-map show-map="$ctrl.showMap" map-points="$ctrl.mapPoints" detailed-info="true" show-expanded="false" view-map-handler="$ctrl.viewMapHandler(mapPoint)" map-refresh-handler="$ctrl.refreshPageData()"></load-map>
      <div class="row view-full-map-button-row">
        <div class="col-xs-offset-5 col-xs-2 text-center">
          <button ng-if="!$ctrl.showExpandedMap && !$ctrl.showLoadDetailsMap" ng-click="$ctrl.toggleExpandedMap()" class="btn view-full-map-button">
            View Full Map
          </button>
        </div>
      </div>
      <div class="container main-content">
      <section>
        <div class="section-head">
          <h1 class="section-label">
            Loads Requiring Online Reporting
          </h1>
          <a ui-sref="{{$ctrl.activeLoadsRoute}}">View All {{$ctrl.activeLoadsCount}} Active Loads</a>
        </div>
        <load-table rep-details="$ctrl.repDetails" ng-if="$ctrl.showActionLoadsLoading || $ctrl.activeLoads.length > 0"
                    loads="$ctrl.activeLoads" load-type="$ctrl.loadType" carrier-id="$ctrl.carrierId"
                    show-loading="$ctrl.showActionLoadsLoading" refresh-table-callback="$ctrl.fetchLoadsNeedingAction()"></load-table>
        <show-more paging-model="$ctrl.pagingActionLoads" show-loading="$ctrl.showMoreActionLoadsLoading" record-type="Loads" click-handler="$ctrl.showMoreActionLoadsHandler()"></show-more>
        <div class="no-loads-message" ng-if="!$ctrl.showActionLoadsLoading && $ctrl.activeLoads.length === 0">
          <h3>You have no loads that need online actions right now.</h3>
          <div>You have <a ui-sref="{{$ctrl.activeLoadsRoute}}">{{$ctrl.activeLoadsCount}} active loads</a> at this time.</div>
        </div>
      </section>
      <section class="multi-stop-loads">
        <div class="section-head">
          <h1 class="section-label">
            Multi-Stop Loads
            <span class="section-sub-label">
                with Upcoming Appointments
              </span>
          </h1>
        </div>
        <load-table rep-details="$ctrl.repDetails" loads="$ctrl.multiStopLoads" load-type="$ctrl.loadType" show-loading="$ctrl.showMultiStopLoading" carrier-id="$ctrl.carrierId" refresh-table-callback="$ctrl.fetchMultistopLoads()"></load-table>
      <show-more show-loading="$ctrl.showMoreMultiStopLoading" paging-model="$ctrl.pagingMultistopLoads" record-type="Loads" click-handler="$ctrl.showMoreMultiStopLoadsHandler()"></show-more>
      </section>
    </div>
  </div>
</div>
